(()=>{"use strict";const e="/dist/";let t=new class{constructor(){this.firstDate=new Date(2020,0,14),this.lastDate=new Date,this.lastDate.setDate(this.lastDate.getDate()-1),this.lastDate.getTime()>new Date(2021,2,6).getTime()&&(this.lastDate=new Date(2021,2,6))}getUSTotals(){fetch("").then((e=>e.json())).then((e=>{e[0]})).catch((e=>{console.error(e)}))}getUSTotalsByDate(){let e=document.getElementById("year-input").value,t=document.getElementById("months-input").value-1,n=document.getElementById("days-input").value;const a=new Date(e,t,n);if(this.firstDate.getTime()>a.getTime()||this.lastDate.getTime()<a.getTime())return void(document.getElementById("data-container").innerHTML="Invalid input, out of bounds");let i=new Intl.DateTimeFormat("en",{year:"numeric"}).format(a)+"-"+new Intl.DateTimeFormat("en",{month:"2-digit"}).format(a)+"-"+new Intl.DateTimeFormat("en",{day:"2-digit"}).format(a);return document.getElementById("data-container").innerHTML="Loading...",fetch("https://api.covidtracking.com/v2/us/daily/"+i+".json").then((e=>e.json())).then((e=>e.data)).catch((e=>{console.error(e)}))}getAllUSData(){return document.getElementById("data-container").innerHTML="Loading...",fetch("https://api.covidtracking.com/v2/us/daily.json").then((e=>e.json())).then((e=>{let t=e.data;return t.pop(),t.pop(),t}))}getAllStatesData(){let e=document.getElementById("state-input").value;return document.getElementById("data-container").innerHTML="Loading...",fetch("https://api.covidtracking.com/v2/states/"+e+"/daily.json").then((e=>e.json())).then((e=>{let t=e.data;for(;null===t[t.length-1].cases.total.value;)t.pop();return t}))}},n=new class{constructor(){this.buildForm=new class{constructor(){this.states={1:"AL",2:"AK",3:"AZ",4:"AR",5:"CA",6:"CO",7:"CT",8:"DE",9:"FL",10:"GA",11:"HI",12:"ID",13:"IL",14:"IN",15:"IA",16:"KS",17:"KY",18:"LA",19:"ME",20:"MD",21:"MA",22:"MI",23:"MN",24:"MS",25:"MO",26:"MT",27:"NE",28:"NV",29:"NH",30:"NJ",31:"NM",32:"NY",33:"NC",34:"ND",35:"OH",36:"OK",37:"OR",38:"PA",39:"RI",40:"SC",41:"SD",42:"TN",43:"TX",44:"UT",45:"VT",46:"VA",47:"WA",48:"WV",49:"WI",50:"WY"},this.months={0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"}}generateMonthsMenu(){let e=document.getElementById("set-date"),t=document.createElement("label"),n=document.createElement("select"),a=document.getElementById("menus-container");t.htmlFor="months",n.name="months",n.id="months-input";for(let e=0;e<12;e++){let t=document.createElement("option");t.value=e+1,t.innerHTML=this.months[e],n.appendChild(t)}n.addEventListener("change",this.generateDaysMenu.bind(this)),e.appendChild(t),a.appendChild(n)}daysInMonth(e,t){return new Date(t,e,0).getDate()}generateDaysMenu(e=0){let t=document.getElementById("year-input").value,n=document.getElementById("months-input").value,a=this.daysInMonth(n,t),i=document.getElementById("days-input");i.innerHTML="";for(let t=1;t<a+1;t++){let n=document.createElement("option");n.value=t,n.innerHTML=t,e===t&&(n.selected="selected"),i.appendChild(n)}}generateSelectSingleDate(){this.generateMonthsMenu();let e=document.getElementById("set-date"),t=document.createElement("label"),n=document.createElement("select"),a=document.getElementById("menus-container");t.htmlFor="days",n.name="days",n.id="days-input",e.appendChild(t),a.appendChild(n),this.generateDaysMenu(14);let i=document.createElement("button");i.type="button",i.innerHTML="Submit",i.id="submit-btn",e.appendChild(i),document.getElementById("year-input").addEventListener("change",this.generateDaysMenu.bind(this))}generateStateDropDownMenu(){let e=document.getElementById("state-input");for(let t=1;t<51;t++){let n=document.createElement("option");n.value=this.states[t],n.innerHTML=this.states[t],e.appendChild(n)}}}}displayAllData(e){let t=document.getElementById("data-container");t.innerHTML="";let n=document.createElement("div"),a=new Intl.DateTimeFormat("en",{month:"short"}).format(new Date(e[e.length-1].date)),i=new Intl.DateTimeFormat("en",{year:"numeric"}).format(new Date(e[e.length-1].date)),l=document.createElement("div"),o=0;for(let d=e.length-1;d>=0;d--){let s=new Intl.DateTimeFormat("en",{year:"numeric"}).format(new Date(e[d].date)),m=new Intl.DateTimeFormat("en",{month:"short"}).format(new Date(e[d].date)),r=new Intl.DateTimeFormat("en",{day:"numeric"}).format(new Date(e[d].date));0!==a.localeCompare(m)&&(l.innerHTML=a+" "+i,this.buildMonthContainer(l,n,t,o),o++,l=document.createElement("div"),n=document.createElement("div"),a=m,i=s),n.appendChild(this.buildDataPoint(e[d],r))}l.innerHTML=a+" "+i,this.buildMonthContainer(l,n,t,o)}buildDataPoint(e,t){let n=document.createElement("div");return n.appendChild(this.makeElement("day-data-point",t,"span")),n.appendChild(this.buildTotalNewContainer(e)),n.classList.add("data-point"),n}buildTotalNewContainer(e){let t=document.createElement("div"),n=document.createElement("div");return n.classList.add("total-new-container"),t.appendChild(this.makeElement("labels-data-point"," Total: ","span")),t.appendChild(this.makeElement("numbers-data-point",this.numberWithCommas(e.cases.total.value||0),"span")),n.appendChild(t),t=document.createElement("div"),t.appendChild(this.makeElement("labels-data-point"," New: ","span")),t.appendChild(this.makeElement("numbers-data-point",this.numberWithCommas(e.cases.total.calculated.change_from_prior_day||0),"span")),n.appendChild(t),n}buildMonthContainer(e,t,n,a){t.classList.add("month-container"),e.classList.add("month-heading"),e.id=a,t.id=a+"container",e.addEventListener("click",this.expandMonth.bind(this)),n.appendChild(e),n.appendChild(t)}displayOneDayOfUSTotals(e){let t=e.cases.total.value,n=e.cases.total.calculated.change_from_prior_day,a=e.cases.total.calculated.population_percent,i=e.testing.total.value,l=e.outcomes.death.total.value,o=e.outcomes.death.total.calculated.population_percent,d={Cases:this.numberWithCommas(t||0),"New Cases":this.numberWithCommas(n||0),"Percent of population infected":(a||0)+"%","Total tests administered":this.numberWithCommas(i||0),"Total death toll":this.numberWithCommas(l||0),"Percent of population dead":(o||0)+"%"},s=Object.keys(d),m=document.getElementById("data-container");m.innerHTML="";for(let e=0;e<s.length;e++){let t=document.createElement("div");t.classList.add("data-details"),t.innerHTML=s[e]+": "+d[s[e]],m.appendChild(t)}}numberWithCommas(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}makeElement(e,t,n){let a=document.createElement(n);return a.classList.add(e),a.innerHTML=t,a}expandMonth(e){let t=e.srcElement,n=document.getElementById(t.id+"container"),a=document.getElementById("animation-style"),i=45*n.childNodes.length;n.style.animationName==="collapse-month"+i||""===n.style.animationName?(a.innerHTML+="                @keyframes expand-month"+i+"{                    from{                        visibility: hidden;                        height: 0;                    }                    to{                        visibility: visible;                        height:"+i+"px;                    }                }                @keyframes collapse-month"+i+"{                    from{                        visibility: visible;                        height:"+i+"px;                    }                    to{                        visibility: hidden;                        height: 0;                    }                }",n.style.animationName="expand-month"+i):n.style.animationName="collapse-month"+i}};async function a(){let e=await t.getAllStatesData();n.displayAllData(e)}async function i(){let e=await t.getUSTotalsByDate();n.displayOneDayOfUSTotals(e)}0===window.location.pathname.localeCompare(e+"index.html")||(0===window.location.pathname.localeCompare(e+"all_country_data.html")?async function(){let e=await t.getAllUSData();e.pop(),e.pop(),n.displayAllData(e)}():0===window.location.pathname.localeCompare(e+"all_states_data.html")?(n.buildForm.generateStateDropDownMenu(),document.getElementById("state-input").addEventListener("change",a),a()):0===window.location.pathname.localeCompare(e+"single_day.html")&&(n.buildForm.generateSelectSingleDate(),document.getElementById("submit-btn").addEventListener("click",i),i()))})();